<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muiii æ¶ç¥¨æˆ°ç¸¾</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        .card-success { border-top: 5px solid #10b981; }
        .card-fail { border-top: 5px solid #ef4444; }
        .badge-success { background-color: #d1fae5; color: #065f46; }
        .badge-fail { background-color: #fee2e2; color: #991b1b; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ† Muiii æ¶ç¥¨æˆ°ç¸¾è¡¨</h1>
            <p class="text-gray-500">åŒæ­¥è‡ª Google Sheets çš„å³æ™‚ç´€éŒ„</p>
            <div id="stats" class="mt-6 flex justify-center gap-4 text-sm">
                </div>
        </header>

        <div id="loading" class="text-center py-20">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div>
            <p class="mt-4 text-gray-500">æ­£åœ¨è®€å–æˆ°ç¸¾è³‡æ–™...</p>
        </div>

        <div id="record-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
    </div>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vThZZurHBpfes9J-dLaoi51jpb0MnQ4oABmBux77r-OO5LOvuoex6lesE4GvZb-UQ5zgiqWEfiHxNQy/pub?output=csv';

        async function fetchRecords() {
            Papa.parse(csvUrl, {
                download: true,
                header: true,
                complete: function(results) {
                    renderCards(results.data);
                    document.getElementById('loading').classList.add('hidden');
                }
            });
        }

        function renderCards(data) {
            const grid = document.getElementById('record-grid');
            const statsContainer = document.getElementById('stats');
            let successCount = 0;

            data.forEach(item => {
                // å‡è¨­ CSV æ¬„ä½åç¨±ç‚ºï¼šæ—¥æœŸ, æ´»å‹•åç¨±, ç‹€æ…‹, åº§ä½å€, å‚™è¨»
                if (!item.æ´»å‹•åç¨±) return; 

                const isSuccess = item.ç‹€æ…‹ === 'æˆåŠŸ';
                if (isSuccess) successCount++;

                const card = document.createElement('div');
                card.className = `bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-shadow ${isSuccess ? 'card-success' : 'card-fail'}`;
                
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <span class="text-xs font-medium text-gray-400">${item.æ—¥æœŸ || ''}</span>
                        <span class="px-2 py-1 rounded text-xs font-bold ${isSuccess ? 'badge-success' : 'badge-fail'}">
                            ${item.ç‹€æ…‹}
                        </span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">${item.æ´»å‹•åç¨±}</h3>
                    <p class="text-gray-600 text-sm mb-4">ğŸ“ ${item.åº§ä½å€ || 'æœªå¡«å¯«'}</p>
                    <div class="text-gray-400 text-xs italic border-t pt-4">
                        ${item.å‚™è¨» || 'ç„¡å‚™è¨»è³‡è¨Š'}
                    </div>
                `;
                grid.appendChild(card);
            });

            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            const winRate = ((successCount / data.length) * 100).toFixed(1);
            statsContainer.innerHTML = `
                <span class="bg-blue-100 text-blue-700 px-4 py-2 rounded-full border border-blue-200">ç¸½å ´æ¬¡ï¼š${data.length}</span>
                <span class="bg-green-100 text-green-700 px-4 py-2 rounded-full border border-green-200">æˆåŠŸï¼š${successCount}</span>
                <span class="bg-purple-100 text-purple-700 px-4 py-2 rounded-full border border-purple-200">å‹ç‡ï¼š${winRate}%</span>
            `;
        }

        fetchRecords();
    </script>
</body>
</html>